# Руководство по параметру Temperature

## Что такое Temperature?

Temperature (температура) - это параметр, который контролирует степень "креативности" и случайности в ответах Claude AI.

## Диапазон значений

**Claude API поддерживает диапазон: 0.0 - 1.0**

### Значения:

- **0.0** - Максимально предсказуемые, консервативные ответы
  - Лучше всего для: аналитических задач, multiple choice, точных ответов
  - Характер: детерминированный, фокусированный

- **0.5** - Сбалансированное поведение
  - Лучше всего для: общего назначения, смешанных задач
  - Характер: умеренное разнообразие

- **1.0** - Максимальная креативность и разнообразие (по умолчанию в Claude)
  - Лучше всего для: креативных задач, генерации текста, брейнсторминга
  - Характер: разнообразный, креативный

⚠️ **Важно**: Даже при temperature = 0.0, ответы не будут полностью детерминированными.

## Как проверить, что temperature работает?

### 1. Через логи сервера

При запущенном сервере (`./gradlew run`) вы увидите в логах:

```
INFO  d.s.services.ClaudeService - Using temperature: 0.7
```

### 2. Автоматический тест

Запустите тестовый скрипт:

```bash
./test_temperature.sh
```

Скрипт отправит одинаковый запрос с тремя разными значениями temperature (0.0, 0.5, 1.0) и покажет различия в ответах.

**Ожидаемый результат:**
- Temperature 0.0: Более структурированные, похожие ответы
- Temperature 0.5: Умеренное разнообразие
- Temperature 1.0: Максимальное разнообразие и креативность

### 3. Ручная проверка через curl

```bash
# Низкая температура
curl -X POST http://localhost:8080/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Напиши стихотворение про осень", "temperature": 0.0, "systemPrompt": "Отвечай обычным текстом"}'

# Высокая температура
curl -X POST http://localhost:8080/api/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "Напиши стихотворение про осень", "temperature": 1.0, "systemPrompt": "Отвечай обычным текстом"}'
```

Отправьте каждый запрос несколько раз и сравните результаты.

### 4. Через веб-интерфейс

1. Откройте http://localhost:8080
2. Измените слайдер "Креативность (Temperature)"
3. Отправьте одинаковый вопрос с разными значениями
4. Проверьте логи сервера для подтверждения

## Примеры влияния temperature

### Пример 1: Аналитическая задача (лучше использовать 0.0-0.3)

**Вопрос**: "Какая столица Франции?"

- **Temperature 0.0**: "Столица Франции - Париж."
- **Temperature 1.0**: "Столица Франции - это Париж, прекрасный город на берегах Сены!"

### Пример 2: Креативная задача (лучше использовать 0.7-1.0)

**Вопрос**: "Напиши короткое стихотворение про кота"

- **Temperature 0.0**: Структурированное, классическое стихотворение
- **Temperature 1.0**: Более креативное, с неожиданными образами

## Результаты тестирования

При запуске `./test_temperature.sh` вы увидите:

```
======================================
1. НИЗКАЯ ТЕМПЕРАТУРА (0.0)
======================================
[Предсказуемый ответ]

======================================
2. СРЕДНЯЯ ТЕМПЕРАТУРА (0.5)
======================================
[Сбалансированный ответ]

======================================
3. ВЫСОКАЯ ТЕМПЕРАТУРА (1.0)
======================================
[Креативный ответ]
```

И в логах сервера:

```
INFO  d.s.services.ClaudeService - Using temperature: 0.0
INFO  d.s.services.ClaudeService - Using temperature: 0.5
INFO  d.s.services.ClaudeService - Using temperature: 1.0
```

## Рекомендации по использованию

1. **Для точных ответов**: используйте 0.0-0.3
2. **Для общего использования**: используйте 0.5-0.7
3. **Для креатива**: используйте 0.8-1.0
4. **Экспериментируйте**: разные задачи могут требовать разных значений
5. **Не смешивайте с top_p**: лучше настраивать либо temperature, либо top_p, но не оба одновременно

## Технические детали

- Параметр передается в запросе к Claude API
- Валидация: значение должно быть в диапазоне [0.0, 1.0]
- При невалидном значении API вернет ошибку 400
- Если temperature не указан, Claude использует значение по умолчанию (1.0)
- Логирование параметра: `ClaudeService.kt:32-36`
